---
title: "Navigating Factors Affecting Job Satisfaction Among Working Americans"
author: "Shirley Chen, Jessica Im"
thanks: ""
platform available at: "TBA"
date: March 4, 2024
date-format: "long" 
format: pdf
editor: visual
toc: true
---

```{r}
#| include: false
### Workspace Setup ###
library(tidyverse)
library(tinytex)
library(janitor)
library(readr)
library(opendatatoronto)
library(here)
library(ggplot2)
library(knitr)
library(usethis)
library(gitcreds)
library(kableExtra)

#### Import data ####
# Question 1 Dataset
cleaned_GSS_data <-
  read_csv("../data/cleaned_GSS_data.csv")

ordered_responses <- c('very_important', 
                       'important',
                       'neither',
                       'not_important',
                       'not_important_at_all')
legend_labels <- c('Very Important', 
                   'Important',
                   'Neither',
                   'Not Important',
                   'Not Important At All')
custom_colours <- c('#FF5733', 
                   '#33FF57',
                   '#3366FF',
                   '#FF33A6',
                   '#FFFF33')
```

# Introduction

# Data

Based at the University of Chicago since 1972, the General Social Survey (GSS) is a project with the objective of monitoring and analyzing the intricacies of American society (1). The GSS Data Explorer makes it so that data retrieved from the project is a publicly available resource, accessible to various types of people, such as educators, policymakers, or researchers through the National Opinion Research Center (NORC).

The dataset used for this paper was retrieved from The General Social Survey (GSS) Data Explorer website (citation). We retrieved survey data relating to work and job in the years of 1989, 1998, 2006, and 2016.

## Source Data

All the survey data used was in relation to job and work in the Work Orientation Module; the specific variable names extracted from the dataset being intjob, hlpoths, and hlpsoc, as shown in Table 1.

```{r}
#| tbl-cap: yup 
#| echo: false

variable_data <- data.frame( 
  Variable = c("intjob", 
               "hlpoths", 
               "hlpsoc"), 
  NewName = c("interesting_work", 
              "helping_others", 
              "social_usefulness"), 
  Description = c("Importance of interesting work in a job",
                  "Importance of helping others in a job",
                  "Importance of social usefulness in a job"), 
  Example = c("Very Important", 
              "Neither", 
              "Not Important")
)
kable(variable_data, 
      caption = "Variables used from GSS dataset",
      format = "simple")

```

## Data Cleaning

The open source statistical programming language R was used to clean and analyze the data, along with producing the graphs. The main packages that supported this process included tidyverse, ggplot2, knitr, kableExtra, here…

The cleaning process involved filtering the specific data variables used for our analysis from the downloaded GSS dataset, and renaming any variables with meaningful names. For example, rather than “intjob” being the column name for “importance of interesting work in a job” , we renamed it to INSERT NAME HERE. Further, the numerical values representing the participants’ responses (1-5) were changed to the representative words/phrases (not important, very important, etc.).

### Importance of a Job that Helps Others

@fig-helpothers displays the proportion of respondents to the prompt "A job that allows someone to help other people?". From the first year of data collection in 1989 to 2006, "Important" was the most selected response. In 2016, "Very Important" surpassed "Important" by 1%. In general, you can see an increase in "Very Important" respondents across the years while there is little change in the proportion of "Not Important" and "Not Important At All" responses.

```{r}
#| label: fig-helpothers
#| echo: false
#| fig-cap: Q1 - "A job that allows someone to help other people?"

# Helping Others Data
helping_others_data <- cleaned_GSS_data[c('year',
                                          'helping_others')]

helping_others_percentages <- 
  helping_others_data |>
  count(year, helping_others) |>
  group_by(year) |>
  mutate(percentage = n / sum(n) * 100) 
helping_others_percentages

helping_others_percentages$helping_others <- factor(
  helping_others_percentages$helping_others, levels =
    ordered_responses)

ggplot(helping_others_percentages, aes(
  x = as.factor(year),
  y = percentage, 
  fill = helping_others)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Helping Others Responses by Year",
       x = "Year",
       y = "Percentage",
       fill = "Responses") +
  scale_y_continuous(labels = scales::percent_format(scale = 1), 
                     limits = c(0, 100)) + 
  scale_fill_manual(values = custom_colours,
                    breaks = c('very_important', 
                       'important',
                       'neither',
                       'not_important',
                       'not_important_at_all'),
                    labels = c('Very Important', 
                   'Important',
                   'Neither',
                   'Not Important',
                   'Not Important At All')) + 
  theme_minimal()
```

### Importance of a Job that is Interesting

@fig-interestingwork shows the proportion of responses for the prompt "An interesting job?". In 1989, "Important" responses was most chosen at around 50%. The following survey, in 1998, showed an increase in "Very Important" responses, where it had a similar proportion to "Important" responses 1989 and "Important" decreased to a proportion similar to "Very Important".

```{r}
#| label: fig-interestingwork
#| echo: false
#| fig-cap: Q2 - "An interesting job?"

# Interesting Work Data
interesting_work_data <- cleaned_GSS_data[c('year', 'interesting_work')]

interesting_work_percentages <- interesting_work_data |>
  count(year, interesting_work) |>
  group_by(year) |>
  mutate(percentage = n / sum(n) * 100) 

interesting_work_percentages$interesting_work <- factor(
  interesting_work_percentages$interesting_work, levels = ordered_responses)

ggplot(interesting_work_percentages, aes(
  x = as.factor(year),
  y = percentage, 
  fill = interesting_work)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Interesting Work Responses by Year",
       x = "Year",
       y = "Percentage",
       fill = "Responses") +
  scale_y_continuous(labels = scales::percent_format(scale = 1), 
                     limits = c(0, 100)) + 
  scale_fill_manual(values = custom_colours,
                    breaks = c('very_important', 
                       'important',
                       'neither',
                       'not_important',
                       'not_important_at_all'),
                    labels = c('Very Important', 
                   'Important',
                   'Neither',
                   'Not Important',
                   'Not Important At All')) + 
  theme_minimal()
```

### Importance of a Job that is Useful to Society

@fig-useful displays the proportion of responses for the prompt "A job that is useful to society?". There is a large increase in the proportion of "Very Important" responses from 1989 to 2016. In contrast, there is a gradual decline for both "Important" and "Neither". There is little change in "Not Important" and "Not Important At All".

```{r}
#| label: fig-useful
#| echo: false
#| fig-cap: Q3 - "A job that is useful to society?"

# Social Usefulness Data
social_usefulness_data <- cleaned_GSS_data[c('year', 'social_usefulness')]

social_usefulness_percentages <- social_usefulness_data |>
  count(year, social_usefulness) |>
  group_by(year) |>
  mutate(percentage = n / sum(n) * 100) 

social_usefulness_percentages$social_usefulness <- factor(
  social_usefulness_percentages$social_usefulness, levels = ordered_responses)

ggplot(social_usefulness_percentages, aes(
  x = as.factor(year),
  y = percentage, 
  fill = social_usefulness)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Social Usefulness Responses by Year",
       x = "Year",
       y = "Percentage",
       fill = "Responses") +
  scale_y_continuous(labels = scales::percent_format(scale = 1), 
                     limits = c(0, 100)) + 
  scale_fill_manual(values = custom_colours,
                    breaks = c('very_important', 
                       'important',
                       'neither',
                       'not_important',
                       'not_important_at_all'),
                    labels = c('Very Important', 
                   'Important',
                   'Neither',
                   'Not Important',
                   'Not Important At All')) + 
  theme_minimal()
```

# Results

## Respondent Demographics

### 1989

@fig-demos1989 shows...

```{r}
#| label: fig-demos1989
#| echo: false
demographic_1989 <- cleaned_GSS_data |>
  filter(year==1989) |>
  group_by(sex)|>
  summarise(count = n())

demographic_1989 <- demographic_1989 |>
  mutate(percentage = round((count / sum(count)) * 100, 2))

demographic_1989 <- demographic_1989 |>
  select(-count)

kable(demographic_1989,
      col.names = c("Sex", "Percentage")) |>
  kable_styling(full_width = FALSE)

```

### 1998

In @fig-demos1998, the \_ is shown.

```{r}
#| label: fig-demos1998
#| echo: false
demographic_1998 <- cleaned_GSS_data |>
  filter(year==1998) |>
  group_by(sex)|>
  summarise(count = n())

demographic_1998 <- demographic_1998 |>
  mutate(percentage = round((count / sum(count)) * 100, 2))

demographic_1998 <- demographic_1998 |>
  select(-count)

kable(demographic_1998,
      col.names = c("Sex", "Percentage")) |>
  kable_styling(full_width = FALSE)

```

### 2006

@fig-demos2006 shows

```{r}
#| label: fig-demos2006 
#| echo: false
demographic_2006 <- cleaned_GSS_data |>
  filter(year==2006) |>
  group_by(sex)|>
  summarise(count = n())

demographic_2006 <- demographic_2006 |>
  mutate(percentage = round((count / sum(count)) * 100, 2))

demographic_2006 <- demographic_2006 |>
  select(-count)

kable(demographic_2006,
      col.names = c("Sex", "Percentage")) |>
  kable_styling(full_width = FALSE)
```

### 2016

@fig-demos2016 shows

```{r}
#| label: fig-demos2016
#| echo: false
demographic_2016 <- cleaned_GSS_data |>
  filter(year==2016) |>
  group_by(sex)|>
  summarise(count = n())

demographic_2016 <- demographic_2016 |>
  mutate(percentage = round((count / sum(count)) * 100, 2))

demographic_2016 <- demographic_2016 |>
  select(-count)

kable(demographic_2016,
      col.names = c("Sex", "Percentage")) |>
  kable_styling(full_width = FALSE)
```

@fig-avgresponses summarizes the average of responses per year for each variable.

```{r}
#| label: fig-avgresponses
#| tbl-cap: Average of Responses by Year
#| echo: false

helping_others_avg <- cleaned_GSS_data |>
  group_by(year) |>
  summarize(
    avg_helping_others = round(mean(helping_others), 3))

interesting_work_avg <- cleaned_GSS_data |>
  group_by(year) |>
  summarize(
    avg_interesting_work = round(mean(interesting_work), 3))

social_usefulness_avg <- cleaned_GSS_data |>
  group_by(year) |>
  summarize(
    avg_helping_others = round(mean(social_usefulness), 3))

combined_table <- cbind(
  helping_others_avg, 
  interesting_work_avg[, -1],
  social_usefulness_avg[, -1])

kable(combined_table,
      format = "markdown", 
      col.names = c("Year",
                    "Helping Others",
                    "Interesting Work",
                    "Social Usefulness"),
      digits = 3,
      booktabs = TRUE,
      linesep = "")
```

# Average change

In @fig-avgchange, the average changer for "very important" and "important" responses to how important is a job in which you help others.

```{r}
#| label: fig-avgchange
#| tbl-cap: avg change for very important and important responses for helping others 
#| echo: false

# Very Important Differences

## Helping Others
helping_others_VI_2016 <- helping_others_data |>
  filter(year==2016, helping_others =="very_important") |>
  summarise(count = n())
  
helping_others_VI_1989 <- helping_others_data |>
  filter(year==1989, helping_others =="very_important") |>
  summarise(count = n())

avg_change_helping_others <- round((
  helping_others_VI_2016 - helping_others_VI_1989) / 
    (2016-1989), 2)

## Social Usefulness
social_usefulness_VI_2016 <- social_usefulness_data |>
  filter(year==2016, social_usefulness =="very_important") |>
  summarise(count = n())
  
social_usefulness_VI_1989 <- social_usefulness_data |>
  filter(year==1989, social_usefulness =="very_important") |>
  summarise(count = n())

avg_change_social_usefulness <- round((
  social_usefulness_VI_2016 - social_usefulness_VI_1989) / 
    (2016-1989), 2)

## Interesting Work
interesting_work_VI_2016 <- interesting_work_data |>
  filter(year==2016, interesting_work =="very_important") |>
  summarise(count = n())
  
interesting_work_VI_1989 <- interesting_work_data |>
  filter(year==1989, interesting_work =="very_important") |>
  summarise(count = n())

avg_change_interesting_work <- round((
  interesting_work_VI_2016 - interesting_work_VI_1989) / 
    (2016-1989), 2)

# Important Differences

## Helping Others
helping_others_I_2016 <- helping_others_data |>
  filter(year==2016, helping_others =="important") |>
  summarise(count = n())
  
helping_others_I_1989 <- helping_others_data |>
  filter(year==1989, helping_others =="important") |>
  summarise(count = n())

avg_change_helping_others_I <- round((
  helping_others_I_2016 - helping_others_I_1989) / 
    (2016-1989), 2)

## Social Usefulness
social_usefulness_I_2016 <- social_usefulness_data |>
  filter(year==2016, social_usefulness =="important") |>
  summarise(count = n())
  
social_usefulness_I_1989 <- social_usefulness_data |>
  filter(year==1989, social_usefulness =="important") |>
  summarise(count = n())

avg_change_social_usefulness_I <- round((
  social_usefulness_I_2016 - social_usefulness_I_1989) / 
    (2016-1989), 2)

## Interesting Work
interesting_work_I_2016 <- interesting_work_data |>
  filter(year==2016, interesting_work =="important") |>
  summarise(count = n())
  
interesting_work_I_1989 <- interesting_work_data |>
  filter(year==1989, interesting_work =="important") |>
  summarise(count = n())

avg_change_interesting_work_I <- round((
  interesting_work_I_2016 - interesting_work_I_1989) / 
    (2016-1989), 2)
```

```{r}
cleaned_GSS_data
```
@fig-allresponse-helpingothers demonstrates the changing proportion of responses to how important is it for a job to help others. 
```{r}
#|label: fig-allresponse-helpingothers
#|echo: false
#|message: false
#|tbl-cap: Proportion of Responses to Importance of Job that Helps Other

# Prepare data
helping_others_data <- cleaned_GSS_data[c('year',
                                          'helping_others')]

helping_others_data <-helping_others_data |>
  mutate(
    helping_others = recode(helping_others, 
                            '1' = 'Very Important',
                            '2' = 'Important',
                            '3' = 'Neither',
                            '4' = 'Not Important',
                            '5' = 'Not Important At All'),
  )

helping_others_data <-
  helping_others_data |>
  mutate(
    year = (as.character(year)),
  )

helping_others_percentages <- 
  helping_others_data |>
  count(year, helping_others) |>
  group_by(year) |>
  mutate(percentage = n / sum(n) * 100)


# Graph data
helping_others_percentages |>
  ggplot(mapping = aes(x = year, y = percentage, fill = helping_others)) +
  geom_col() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle=90, size = 10)) +
  labs(x = "Year", y = "Proportion for each response (%)", fill = "Response") +
  theme(legend.position = "bottom") +
  theme(legend.text = element_text(size = 5)) +
  scale_fill_viridis_d(option = "viridis") 
```



```{r}
#|label: fig-allresponse-helpingothers
#|echo: false
#|message: false
#|tbl-cap: Proportion of Responses to Importance of Job that Helps Other

# Prepare data
helping_others_data <- cleaned_GSS_data[c('year',
                                          'helping_others')]

helping_others_data <-helping_others_data |>
  mutate(
    helping_others = recode(helping_others, 
                            '1' = 'Very Important',
                            '2' = 'Important',
                            '3' = 'Neither',
                            '4' = 'Not Important',
                            '5' = 'Not Important At All'),
  )

helping_others_data <-
  helping_others_data |>
  mutate(
    year = (as.character(year)),
  )

helping_others_percentages <- 
  helping_others_data |>
  count(year, helping_others) |>
  group_by(year) |>
  mutate(percentage = n / sum(n) * 100)


# Graph data
helping_others_percentages |>
  ggplot(mapping = aes(x = year, y = percentage, fill = helping_others)) +
  geom_col() +
  theme_minimal() +
  theme(axis.text.x = element_text(angle=90, size = 10)) +
  labs(x = "Year", y = "Proportion for each response (%)", fill = "Response") +
  theme(legend.position = "bottom") +
  theme(legend.text = element_text(size = 5)) +
  scale_fill_viridis_d(option = "viridis") 
```


# Discussion

## Gender?

## Culture?

# Sources
